<link href="https://cdn.jsdelivr.net/npm/froala-editor@latest/css/froala_editor.pkgd.min.css" rel="stylesheet"> 



{{#if
    errorMessage}} <p class="text-red-500 font-bold">{{errorMessage}}</p>
{{else}}
<div class="max-w-[1400px] mx-auto bg-white p-6 shadow-md rounded-lg">
    <h2 class="text-xl font-bold mb-4">Create a Blog</h2>


    <form class="space-y-4">

        <label class="block">
            <span class="text-gray-700">Blog Title</span>
            <input type="text" id="blogTitle"
                class="mt-1 block w-full px-4 py-2 border rounded-md focus:ring focus:ring-blue-300" required>
        </label>



        <label class="block">
            <span class="text-gray-700">Short Description</span>
            <input type="text" id="blogDescShort"
                class="mt-1 block w-full px-4 py-2 border rounded-md focus:ring focus:ring-blue-300" required>
        </label>

        <label class="block">
            <span class="text-gray-700">Image URL</span>
            <input type="text" id="blogImageUrl"
                class="mt-1 block w-full px-4 py-2 border rounded-md focus:ring focus:ring-blue-300" required>
        </label>


            <label class="block">
    <span class="text-gray-700">Category</span>
    <select id="category" class="mt-1 block w-full px-4 py-2 border rounded-md focus:ring focus:ring-blue-300" required>
        <option value="" disabled selected>Select a category</option>
        <option value="Political">Political</option>
        <option value="Vacation">Vacation</option>
        <option value="Travel">Travel</option>
        <option value="Technology">Technology</option>
        <option value="Health">Health</option>
        <option value="Education">Education</option>
        <option value="Entertainment">Entertainment</option>
    </select>
</label>


        <label class="block">
            <span class="text-gray-700">Blog Description</span>
        </label>
        <textarea name="blogDesc" id="blogDesc" required></textarea>

        <button type="submit" id="submit" 
            class="w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700">Submit</button>
    </form>
</div>


{{/if}}





<script src="https://cdn.jsdelivr.net/npm/froala-editor@latest/js/froala_editor.pkgd.min.js"></script>


<script>


  const editor = new FroalaEditor("#blogDesc", {
        placeholderText: "Write your blog here...",
        heightMin: 600
    });

    


    document.getElementById("submit").addEventListener("click", async (event) => {

        event.preventDefault()

        const blogTitle = document.getElementById("blogTitle").value
        const blogDescShort = document.getElementById("blogDescShort").value
        const blogImageUrl = document.getElementById("blogImageUrl").value
        const category = document.getElementById("category").value
        const blogDesc = editor.html.get()


        const formBody = { blogTitle, blogDesc, blogDescShort, blogImageUrl, category }

        try {
            const res = await fetch("/blog/create", {
                method: "POST",
                headers : {
                    "Content-Type" : "application/json"     //let the server know that the data you're sending is in JSON format.
                },
                body: JSON.stringify(formBody)              //With axios, you can often pass an object directly because axios automatically stringifies the object and sets the appropriate headers for you. However, when using the native fetch API, you need to explicitly convert your object to a JSON string using JSON.stringify(formBody) and manually set the "Content-Type" header to "application/json". This ensures that the server correctly interprets the request body as JSON.
            })
            const data = await res.json()
            //console.log(data.message);

                if(data.message ==="Blog Created Successfully"){
                    window.alert(data.message)

                     // Clear the form inputs:
        document.getElementById("blogTitle").value = "";
        document.getElementById("blogDescShort").value = "";
        document.getElementById("blogImageUrl").value = "";
        document.getElementById("category").selectedIndex = 0; // Reset dropdown to default option
        
        // Clear Froala Editor content without messing its settings:
        editor.html.set("");
                }
                else{
                    window.alert("SOME Error")
                }
        
        }
        catch (error) {
            console.log(error)
        }


    })




</script>